version: '3'

services:
  server:
    volumes:
      - /var/src/server/node_modules
      - './backend:/var/src/server'
    ports:
      - '8080:8080'
    build:
      context: ./backend
      dockerfile: DockerFile
    environment:
      MONGODB_ATLASS_URI: ${MONGODB_ATLASS_URI}
    command: npm start
  app:
    volumes:
      - /var/src/app/node_modules
      - './frontend:/var/src/server'
    ports:
      - '3000:3000'
    build:
      context: ./frontend
      dockerfile: DockerFile
    depends_on:
      - server
    command: npm run build
